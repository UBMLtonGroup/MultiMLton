<HTML
><HEAD
><TITLE
>The Resource Store</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.59"><LINK
REL="HOME"
TITLE="Unix System Programming with Standard ML"
HREF="index.html"><LINK
REL="UP"
TITLE="The Swerve Web Server"
HREF="c3253.html"><LINK
REL="PREVIOUS"
TITLE="The HTTP Protocol"
HREF="x3288.html"><LINK
REL="NEXT"
TITLE="Server Configuration"
HREF="x3464.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="book.css"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Unix System Programming with Standard ML</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x3288.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 8. The Swerve Web Server</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x3464.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="RESOURCESTORE"
>The Resource Store</A
></H1
><P
>Since a URL is a universal <I
CLASS="EMPHASIS"
>resource</I
> locator I'll call the set of web
pages the <I
CLASS="EMPHASIS"
>resource store</I
>. This term will also include any dynamic
web page generators.</P
><P
>The store is a hierarchy of nodes.  The URL is a path through the store
from the top down. Each component of the URL path selects the next node
in the store.  To be nice and general and allow for different kinds of
nodes each node will be passed the remainder of the URL's path and can
decide for itself how to intepret this remainder. For example a node
might be a CGI-BIN script that interprets query parameters.  A node
might also synthesise part of the store dynamically  giving a different
interpretation to the remainder of the path than as just a directory
path on disk. <A
HREF="x3442.html#STOREURL"
>Figure 8-1</A
> shows the passage of a URL path
through the store.</P
><DIV
CLASS="FIGURE"
><A
NAME="STOREURL"
></A
><P
><B
>Figure 8-1. A URL navigating the Resource Store.</B
></P
><DIV
CLASS="MEDIAOBJECT"
><P
><center><IMG
SRC="webserver/storeUrl.png"
></center></IMG
></P
></DIV
></DIV
><P
>The input to the store is a list of URL path segments as described in
<A
HREF="x3288.html#URLSPEC"
>the section called <I
>URL Syntax</I
></A
>. This list is passed in a message to the root node
of the store.</P
><P
>Each node inspects the segment list that it receives. If it is empty
then the node is expected to return an entity. In the figure this is
the file <TT
CLASS="COMPUTEROUTPUT"
>c.html</TT
>.</P
><P
>If the list is not empty then the node inspects the first segment and
chooses another node to send the remainder of the list to. If the node
cannot find another node then an error will be reported.</P
><P
>I won't include the <TT
CLASS="COMPUTEROUTPUT"
>~user</TT
> syntax that Apache supports.</P
><P
>In general a node could contain some state that is updated by the request.
So each of the nodes needs to be a concurrent object in the sense of
<A
HREF="x2442.html#CMLMODELTHREADS"
>the section called <I
>CML Threads</I
> in Chapter 6</A
>.  Different nodes can operate concurrently
so that the store as a whole can handle multiple URLs concurrently.
In addition a node could handle more than one request at a time by
spawning a new thread for each request.  The total number of threads that
can be running in the store will be naturally limited by the maximum
number of connections that will be allowed.  A node may implement some
caching for performance.</P
><P
>Each node will be responsible for controlling access to its part of
the store.  As long as all URL requests are for reading the store and
do not update the store then the nodes can operate independently and
concurrently.  But there might be a node that is the sole representative
of a resource that is updated by a request (for example a hit counter). In
this case the serial behaviour of the node will synchronise access to
the resource.  If more than one node can alter a resource, such as a
database or the file system, then they will have to cooperate through
a lock manager object.
&#13;</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x3288.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x3464.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>The HTTP Protocol</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c3253.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Server Configuration</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
